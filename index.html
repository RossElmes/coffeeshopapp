<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Coffee Shop Order App</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
<div class="container" id="banner">
    <img src="lambertscoffeehouse.png">
    <div class="text-overlay">
        <p>Lambert Coffee House</p>
        <p>Mon-Sat 8-3</p>
        <p>Online Ordering</p>
    </div>
</div>
<!-- Order Form -->
<div class="container">
  <form id="customerForm">
    <label for="email">Email:</label>
    <input type="email" id="email" class="form-control" required><br>

    <label for="name">Name:</label>
    <input type="text" id="name" class="form-control" required><br>

    <label for="phone">Phone:</label>
    <input type="tel" id="phone" class="form-control" required><br>

    <label for="meeting-time">Order time:</label>
    <input type="time" id="orderTime" name="order-time" min="08:10" max="14:00" step="600" class="form-control">
    <br>
    <br>
  </form>
</div>
<div id ='product-list' class='panel panel-default'></div>
<!-- Order Items -->
<div class="formContainer">
  <h2>Your Order</h2>
  <ul id="orderItems"></ul>
  <button type="button" onclick="confirmOrder()">Confirm Order</button>
</div>
<div id="myModal" class="modal">
  <div class="modal-content">
    <span class="close-button" onclick="closeModal()">&times;</span>
    <h2>Order Confirmation</h2>
    <span class="tick">&check;</span>
    <div id="confirmationDetails"></div>
    <button class='close-button-modal' onclick="closeModal()">Close</button>
  </div>
</div>
<script>

  let order = [];

  function removeObjectById(id) {
    const indexToRemove = order.findIndex(obj => obj.id === id);
    if (indexToRemove !== -1) {
      order.splice(indexToRemove, 1);
      updateOrderItems(); // Update the displayed list after removal
    }
  }

  function updateOrderItems() {
    const orderItemsElement = document.getElementById('orderItems');
    orderItemsElement.innerHTML = '';

    order.forEach((item, index) => {
      const listItem = document.createElement('li');
      const deleteButton = document.createElement("button");
      deleteButton.textContent = "Delete";
      listItem.textContent = `${item.product} - ${item.price}`;

      deleteButton.addEventListener("click", () => {

        removeObjectById(item.id)

        });

      listItem.append(deleteButton)
      orderItemsElement.appendChild(listItem);
    });
  }

    function confirmOrder() {
        
        console.log(modal)
        //Open the modal
        openModal() 

        const confirmationDetails = document.getElementById('confirmationDetails');
        confirmationDetails.innerHTML = '';
        console.log(confirmationDetails)
        const orderNumber = Math.floor(Math.random() * 1000000) + 1;

        //confirmationDetails.textContent = 'Your order details:';
        order.forEach((item,index) => {
            const listItem = document.createElement('li');
            listItem.textContent = `${item.product} - ${item.price}`;
            confirmationDetails.appendChild(listItem);
        });
        // reset the form when order is made
        document.getElementById('customerForm').reset();
        document.getElementById('orderNumber').textContent = orderNumber;

        console.log(order)

  }

  const products = [
      { id:1,
        name: 'Latte',
        size:'8oz',
        commentary:'Regular Latte made with Milk',
        price:3.50
      },

      { id:2,
        name: 'Large Latte',
        size:'12oz',
        commentary:'Large Latte made with Milk',
        price:3.70
      },
      { id:1,
        name: 'Oat Latte',
        size:'8oz',
        commentary:'Regular Latte made with Oat Milk',
        price:3.50
      },

      { id:2,
        name: 'Large Oat Latte',
        size:'12oz',
        commentary:'Large Latte made with Oat Milk',
        price:3.70
      },
      { id:1,
        name: 'Coconut Latte',
        size:'8oz',
        commentary:'Regular Latte made with Coconut Milk',
        price:3.50
      },
      { id:2,
        name: 'Large Coconut Latte',
        size:'12oz',
        commentary:'Large Latte made with Coconut Milk',
        price:3.70
      },
      // ... more products with different attributes
      { id:3,
        name: 'Flat White',
        size:'8oz',
        commentary:'Flat White made with Regular Milk',
        price:3.40
      },

      { id:4,
        name: 'Oat Flat White',
        size:'8oz',
        commentary:'Flat White made with Oat Milk',
        price:3.80
      },

      { id:5,
        name: 'Coconut Flat White',
        size:'8oz',
        commentary:'Flat White made with Coconut Milk',
        price:3.80
      },

      { id:3,
        name: 'Americano',
        size:'8oz',
        commentary:'Americano with the option of taking it place or adding milk of your choice',
        price:3.40
      },
    ];

    function changeColor(element) {
      // Toggle the "clicked" class to change color on click
      element.classList.toggle('clicked');

      // Set a timeout to remove the "clicked" class after the transition
      setTimeout(() => {
        element.classList.remove('clicked');
      }, 300); // 300ms should match the transition duration
    }

  const productList = document.getElementById('product-list');

  function displayProducts(products) {
    // Clear existing orders in the UI
    productList.innerHTML = '';

     // Display each order in the UI
    products.forEach((product,index) => {
        const prodItem = document.createElement('div');
        prodItem.id = product.id
        //const AddButton = document.createElement("button");
        //AddButton.textContent = "Add to Order";
        //AddButton.className = 'btn btn-primary'
        prodItem.className = 'panel-body';
        prodItem.innerHTML = `<p>${product.name}</p>`;
        prodItem.innerHTML += `<p>${product.commentary}</p>`;
        prodItem.innerHTML += `<p>Price: €${product.price.toFixed(2)}</p>`;

        prodItem.addEventListener("click", () => {

        const email = document.getElementById('email').value;
        const name = document.getElementById('name').value;
        const phone = document.getElementById('phone').value;
        const orderTime = document.getElementById('orderTime').value;

        // Get selected Product
        const productId = product.id
        const productName = product.name
        const price = '€'+product.price.toFixed(2)


        // Create the order item
        const orderItem = { productId: productId
        , product: productName
        , email:email
        , name:name
        , phone:phone
        , orderTime:orderTime
        , price:price};

        // Add the order item to the order
        order.push(orderItem);
        console.log(product)

        // Display the order items
        updateOrderItems();

        changeColor(prodItem)

        });

        //prodItem.append(AddButton)
        productList.appendChild(prodItem);

    }); 
}

displayProducts(products)

var modal = document.getElementById('myModal');

  function openModal() {
    modal.style.display = 'flex';
  }

  function closeModal() {
    modal.style.display = 'none';
  }



</script>

</body>
</html>
